# unjupiter
運営と運命を共にする、うんち実況（セーラージュピター）

- うんｊは無償の善意で成り立っています。
- お前らのコントリビュート待ってるぜ！
  - （※本番に取り込まれる前に必ずモデレーターのコードレビューが入ります）

## 本プロジェクトのライセンス適用範囲について

本プロジェクトのライセンスは以下の通りです：

1. **AGPL-3.0 License (`LICENSE` ファイル)**
   - 本プロジェクト全体は **GNU Affero General Public License (AGPL-3.0)** のもとでライセンスされています。
   - AGPL-3.0 の詳細については、`LICENSE` をご確認ください。

2. **Apache License 2.0 (`LICENSE-APACHE` ファイル)**
   - 一部のファイル（例: `static/themes/metro-dark.css`）は **Apache License 2.0** で提供されています。
   - Apache License 2.0 の詳細については、`LICENSE-APACHE` をご確認ください。

### 重要な注意事項
- 本プロジェクトを利用・改変・配布する際は、**AGPL-3.0 の条件に従う必要があります**。
- ただし、Apache License のファイル（例: `static/themes/metro-dark.css`）については、**Apache License 2.0 の条件に従って使用できます**。
- それぞれのライセンス条件を確認し、適切に取り扱ってください。

## 採用技術
- Volta
- pnpm
- TypeScript
- JavaScript obfuscator
- フロントエンド
  - Vite
  - Svelte
  - svelte-material-ui@8.0.0-beta.3
- バックエンド
  - esbuild
  - Express
  - Socket.IO
- 自動テスト
  - Vitest（予定）

## 本番ファイルのデプロイ先
- フロントエンド
  - GitHub Pages
  - Cloudflare Pages
- バックエンド
  - Glitch

## UIのこだわり
- 軽快さ
  - SPA特有の高速描画
- 誰もが覚えやすいUI
  - タイトルは2つ以上作らず定位置
  - 真ん中にメインコンテンツ
  - 左のサイドメニューは各機能への導線
  - 右のサイドメニューは固有のUI（スレ検索フォーム、書き込み欄など）
- レスポンシブデザイン
  - PC版：デフォルトでメニューを開いた状態
  - スマホ版：デフォルトでメニューを閉じた状態
- 読み込み順序の都合でレイアウトが崩れるのを防ぐ
  - 画像を読み込む際、あらかじめ高さを予約しておく

## コーディングのこだわり
- 情報量を減らす
  - フォルダ構造を深くしない
  - そのスコープの中で衝突しない、最も簡素な命名にする

## 妄想
- アイソモーフィックなNode.jsパッケージを採用する
  - フロントエンドとバックエンドの両方で動作するもの
  - Valibot: 入力バリデーション（ホワイトリストが望ましい）
  - date-fns: 日付フォーマット
- アンチ荒らし機構
  - 難読化（最高設定）
  - 確率的なBAN（VITE_UNJ_API_FLAKY_RATE）
  - テキスト（入力可能文字種をホワイトリストで制限）
  - 画像のNSFW判定
- その他
  - token引き継ぎ機能

  ## 環境構築
  1. このリポジトリをローカル環境にクローン
  1. このREADME.mdがある階層をvscodeで開く
  1. 拡張機能タブから推奨事項をインストールする
  1. `.env.example`を複製して`.env`にリネーム
  1. このREADME.mdがある階層で`pnpm i`
  1. よく使うコマンド
    - `pnpm run dev`: 開発環境ビルド（バックエンドはtsxで直接実行される）
    - `pnpm run stg`: 検証環境ビルド（idb難読化+ソース難読化+nodeで実行される）
    - `pnpm run prod`: 本番環境ビルド（ルーティング以外は検証環境ビルドと同じはず…）
    - `pnpm run sync`: ビルド成果物を親の別のディレクトリに複製する

  ---

  - 開発環境ビルドと検証環境ビルドは`http://localhost:3000/`から動作確認可能。
  - 本番環境ビルドは`src\server\index.ts`を改造する必要あり（※動作確認する前提のコマンドではない）
  - 環境変数は`.env.example`のデフォルト値から変えなくても動くはず…